<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharmacy Management - MediCare Hospital System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --secondary: #34a853;
            --accent: #fbbc05;
            --danger: #ea4335;
            --light: #f8f9fa;
            --dark: #202124;
            --gray: #5f6368;
            --sidebar-width: 250px;
            --header-height: 70px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7fa;
            color: var(--dark);
            overflow-x: hidden;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            position: fixed;
            height: 100vh;
            transition: var(--transition);
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 24px;
        }

        .logo h1 {
            font-size: 20px;
        }

        .logo span {
            color: var(--secondary);
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
            border-left: 3px solid transparent;
        }

        .menu-item:hover, .menu-item.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-left-color: var(--secondary);
        }

        .menu-item i {
            width: 20px;
            text-align: center;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
        }

        /* Header Styles */
        .header {
            background: white;
            height: var(--header-height);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left h2 {
            color: var(--dark);
            font-size: 24px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .notification-icon {
            position: relative;
            cursor: pointer;
            padding: 10px;
            color: var(--gray);
        }

        .notification-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Content Area */
        .content {
            padding: 30px;
        }

        /* Pharmacy Specific Styles */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 20px;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-success {
            background-color: var(--secondary);
            color: white;
        }

        .btn-warning {
            background-color: var(--accent);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        /* Pharmacy Dashboard */
        .pharmacy-dashboard {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        /* Inventory Overview */
        .inventory-overview {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .inventory-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .inventory-stat {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            background: var(--light);
        }

        .inventory-stat.critical {
            background: #ffebee;
            border: 2px solid #ffcdd2;
        }

        .inventory-stat.warning {
            background: #fff8e1;
            border: 2px solid #ffe082;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 14px;
        }

        /* Quick Actions */
        .quick-actions {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .action-buttons {
            display: grid;
            gap: 15px;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: var(--light);
            border: 2px dashed #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .action-btn:hover {
            background: #e3f2fd;
            border-color: var(--primary);
        }

        .action-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .action-text h4 {
            margin-bottom: 5px;
            font-size: 16px;
        }

        .action-text p {
            color: var(--gray);
            font-size: 12px;
        }

        /* Inventory Grid */
        .inventory-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-header h3 {
            font-size: 20px;
            color: var(--dark);
        }

        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-control {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .drug-card {
            background: white;
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 20px;
            transition: var(--transition);
            position: relative;
        }

        .drug-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .drug-card.low-stock {
            border-left: 4px solid var(--accent);
        }

        .drug-card.critical {
            border-left: 4px solid var(--danger);
        }

        .drug-header {
            display: flex;
            justify-content: between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .drug-info h4 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .drug-id {
            color: var(--gray);
            font-size: 12px;
            margin-bottom: 8px;
        }

        .drug-category {
            display: inline-block;
            padding: 3px 8px;
            background: var(--light);
            border-radius: 12px;
            font-size: 11px;
            color: var(--gray);
        }

        .stock-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
        }

        .stock-badge.low {
            background: #fff8e1;
            color: var(--accent);
        }

        .stock-badge.critical {
            background: #ffebee;
            color: var(--danger);
        }

        .stock-badge.good {
            background: #e8f5e8;
            color: var(--secondary);
        }

        .drug-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .detail-item {
            font-size: 13px;
        }

        .detail-label {
            color: var(--gray);
            margin-bottom: 2px;
        }

        .detail-value {
            font-weight: 500;
        }

        .drug-actions {
            display: flex;
            gap: 10px;
        }

        .drug-action-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .drug-action-btn.restock {
            background: #e8f5e8;
            color: var(--secondary);
        }

        .drug-action-btn.dispense {
            background: #e3f2fd;
            color: var(--primary);
        }

        .drug-action-btn.edit {
            background: #fff8e1;
            color: var(--accent);
        }

        /* Prescriptions Section */
        .prescriptions-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .prescriptions-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .prescription-card {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: var(--light);
            border-radius: 8px;
            transition: var(--transition);
        }

        .prescription-card:hover {
            background: #e3f2fd;
        }

        .prescription-card.pending {
            border-left: 4px solid var(--accent);
        }

        .prescription-card.ready {
            border-left: 4px solid var(--secondary);
        }

        .prescription-info {
            flex: 1;
        }

        .prescription-info h4 {
            margin-bottom: 5px;
            font-size: 16px;
        }

        .prescription-meta {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: var(--gray);
        }

        .prescription-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .status-pending {
            background: #fff8e1;
            color: var(--accent);
        }

        .status-ready {
            background: #e8f5e8;
            color: var(--secondary);
        }

        .status-dispensed {
            background: #e3f2fd;
            color: var(--primary);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.4s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            border-bottom: 1px solid #eee;
        }

        .modal-header h2 {
            font-size: 24px;
            color: var(--dark);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--dark);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 30px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            flex: 1;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .pharmacy-dashboard {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .inventory-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .search-filter {
                flex-direction: column;
            }
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--dark);
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-hospital"></i>
                    <h1>Medi<span>Care</span></h1>
                </div>
            </div>
            <div class="sidebar-menu">
                <a href="dashboard.html" class="menu-item">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="patient-management.html" class="menu-item">
                    <i class="fas fa-user-injured"></i>
                    <span>Patient Management</span>
                </a>
                <a href="appointment-scheduler.html" class="menu-item">
                    <i class="fas fa-calendar-check"></i>
                    <span>Appointment Scheduler</span>
                </a>
                <a href="pharmacy.html" class="menu-item active">
                    <i class="fas fa-pills"></i>
                    <span>Pharmacy</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-file-medical"></i>
                    <span>Medical Records</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>Billing</span>
                </a>
                <a href="#" class="menu-item">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
                <a href="index.html" class="menu-item">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h2>Pharmacy Management</h2>
                </div>
                <div class="header-right">
                    <div class="notification-icon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">7</span>
                    </div>
                    <div class="user-profile">
                        <div class="user-avatar">PM</div>
                        <div class="user-info">
                            <div class="user-name">Pharmacy Manager</div>
                            <div class="user-role">Pharmacist</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content -->
            <div class="content">
                <!-- Page Header -->
                <div class="page-header">
                    <div>
                        <h1 style="font-size: 28px; margin-bottom: 5px;">Pharmacy Management</h1>
                        <p style="color: var(--gray);">Manage drug inventory and process prescriptions</p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-outline" onclick="showAddDrugModal()">
                            <i class="fas fa-plus"></i> Add Drug
                        </button>
                        <button class="btn btn-primary" onclick="showNewPrescriptionModal()">
                            <i class="fas fa-prescription"></i> New Prescription
                        </button>
                    </div>
                </div>

                <!-- Pharmacy Dashboard -->
                <div class="pharmacy-dashboard">
                    <!-- Inventory Overview -->
                    <div class="inventory-overview">
                        <h3 style="margin-bottom: 20px; font-size: 20px;">Inventory Overview</h3>
                        <div class="inventory-stats">
                            <div class="inventory-stat">
                                <div class="stat-value">1,247</div>
                                <div class="stat-label">Total Drugs</div>
                            </div>
                            <div class="inventory-stat">
                                <div class="stat-value">45</div>
                                <div class="stat-label">Low Stock Items</div>
                            </div>
                            <div class="inventory-stat critical">
                                <div class="stat-value">12</div>
                                <div class="stat-label">Out of Stock</div>
                            </div>
                            <div class="inventory-stat">
                                <div class="stat-value">28</div>
                                <div class="stat-label">Expiring Soon</div>
                            </div>
                        </div>
                        <div class="inventory-alerts">
                            <h4 style="margin-bottom: 15px; color: var(--dark);">Critical Alerts</h4>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #ffebee; border-radius: 6px;">
                                    <i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i>
                                    <span style="font-size: 14px;">Amoxicillin 500mg is out of stock</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #fff8e1; border-radius: 6px;">
                                    <i class="fas fa-clock" style="color: var(--accent);"></i>
                                    <span style="font-size: 14px;">5 drugs expiring in 30 days</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <h3 style="margin-bottom: 20px; font-size: 20px;">Quick Actions</h3>
                        <div class="action-buttons">
                            <div class="action-btn" onclick="showRestockModal()">
                                <div class="action-icon">
                                    <i class="fas fa-truck-loading"></i>
                                </div>
                                <div class="action-text">
                                    <h4>Restock Inventory</h4>
                                    <p>Add new stock to existing drugs</p>
                                </div>
                            </div>
                            <div class="action-btn" onclick="showExpiryReport()">
                                <div class="action-icon" style="background: var(--accent);">
                                    <i class="fas fa-calendar-times"></i>
                                </div>
                                <div class="action-text">
                                    <h4>Expiry Report</h4>
                                    <p>View drugs expiring soon</p>
                                </div>
                            </div>
                            <div class="action-btn" onclick="showLowStockReport()">
                                <div class="action-icon" style="background: var(--danger);">
                                    <i class="fas fa-exclamation-circle"></i>
                                </div>
                                <div class="action-text">
                                    <h4>Low Stock Alert</h4>
                                    <p>Review critical stock levels</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Inventory Management -->
                <div class="inventory-section">
                    <div class="section-header">
                        <h3>Drug Inventory</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-outline" onclick="exportInventory()">
                                <i class="fas fa-download"></i> Export
                            </button>
                            <button class="btn btn-primary" onclick="showAddDrugModal()">
                                <i class="fas fa-plus"></i> Add New Drug
                            </button>
                        </div>
                    </div>

                    <div class="search-filter">
                        <input type="text" class="form-control" placeholder="Search drugs..." style="flex: 1;" id="searchDrugs">
                        <select class="form-control" id="filterCategory" style="width: 150px;">
                            <option value="">All Categories</option>
                            <option value="antibiotic">Antibiotics</option>
                            <option value="analgesic">Pain Relief</option>
                            <option value="cardiovascular">Cardiovascular</option>
                            <option value="diabetes">Diabetes</option>
                        </select>
                        <select class="form-control" id="filterStock" style="width: 150px;">
                            <option value="">All Stock</option>
                            <option value="critical">Critical</option>
                            <option value="low">Low Stock</option>
                            <option value="good">Good Stock</option>
                        </select>
                    </div>

                    <div class="inventory-grid" id="inventoryGrid">
                        <!-- Drug cards will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Prescriptions Section -->
                <div class="prescriptions-section">
                    <div class="section-header">
                        <h3>Pending Prescriptions</h3>
                        <span style="color: var(--gray); font-size: 14px;">12 prescriptions waiting</span>
                    </div>

                    <div class="prescriptions-list" id="prescriptionsList">
                        <!-- Prescription cards will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Drug Modal -->
    <div class="modal" id="addDrugModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Drug</h2>
                <button class="close-modal" onclick="closeAddDrugModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addDrugForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="drugName">Drug Name *</label>
                            <input type="text" id="drugName" class="form-control" placeholder="Enter drug name" required>
                        </div>
                        <div class="form-group">
                            <label for="drugGeneric">Generic Name</label>
                            <input type="text" id="drugGeneric" class="form-control" placeholder="Enter generic name">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="drugCategory">Category *</label>
                            <select id="drugCategory" class="form-control" required>
                                <option value="">Select Category</option>
                                <option value="antibiotic">Antibiotic</option>
                                <option value="analgesic">Analgesic</option>
                                <option value="cardiovascular">Cardiovascular</option>
                                <option value="diabetes">Diabetes</option>
                                <option value="respiratory">Respiratory</option>
                                <option value="gastrointestinal">Gastrointestinal</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="drugForm">Form *</label>
                            <select id="drugForm" class="form-control" required>
                                <option value="">Select Form</option>
                                <option value="tablet">Tablet</option>
                                <option value="capsule">Capsule</option>
                                <option value="syrup">Syrup</option>
                                <option value="injection">Injection</option>
                                <option value="ointment">Ointment</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="drugStrength">Strength</label>
                            <input type="text" id="drugStrength" class="form-control" placeholder="e.g., 500mg, 10mg/ml">
                        </div>
                        <div class="form-group">
                            <label for="drugManufacturer">Manufacturer</label>
                            <input type="text" id="drugManufacturer" class="form-control" placeholder="Enter manufacturer">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="drugQuantity">Initial Quantity *</label>
                            <input type="number" id="drugQuantity" class="form-control" placeholder="Enter quantity" required min="0">
                        </div>
                        <div class="form-group">
                            <label for="drugReorder">Reorder Level</label>
                            <input type="number" id="drugReorder" class="form-control" placeholder="Reorder level" min="0">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="drugCost">Cost Price</label>
                            <input type="number" id="drugCost" class="form-control" placeholder="Cost price" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="drugPrice">Selling Price</label>
                            <input type="number" id="drugPrice" class="form-control" placeholder="Selling price" step="0.01" min="0">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="drugExpiry">Expiry Date</label>
                            <input type="date" id="drugExpiry" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="drugBatch">Batch Number</label>
                            <input type="text" id="drugBatch" class="form-control" placeholder="Batch number">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="drugDescription">Description</label>
                        <textarea id="drugDescription" class="form-control" placeholder="Enter drug description..." rows="3"></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px;">
                        <i class="fas fa-save"></i> Add Drug to Inventory
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Sample drug inventory data
        const drugs = [
            {
                id: "DRG-001",
                name: "Amoxicillin",
                generic: "Amoxicillin Trihydrate",
                category: "antibiotic",
                form: "capsule",
                strength: "500mg",
                manufacturer: "PharmaCorp",
                quantity: 0,
                reorderLevel: 50,
                cost: 2.50,
                price: 5.00,
                expiry: "2024-12-31",
                batch: "BATCH-AMX-2024",
                description: "Broad-spectrum antibiotic"
            },
            {
                id: "DRG-002",
                name: "Ibuprofen",
                generic: "Ibuprofen",
                category: "analgesic",
                form: "tablet",
                strength: "400mg",
                manufacturer: "PainRelief Inc",
                quantity: 25,
                reorderLevel: 100,
                cost: 0.80,
                price: 2.00,
                expiry: "2025-06-30",
                batch: "BATCH-IBU-2024",
                description: "NSAID for pain and inflammation"
            },
            {
                id: "DRG-003",
                name: "Metformin",
                generic: "Metformin HCl",
                category: "diabetes",
                form: "tablet",
                strength: "500mg",
                manufacturer: "DiabetCare",
                quantity: 150,
                reorderLevel: 50,
                cost: 1.20,
                price: 3.00,
                expiry: "2024-10-15",
                batch: "BATCH-MET-2024",
                description: "Oral anti-diabetic medication"
            },
            {
                id: "DRG-004",
                name: "Lisinopril",
                generic: "Lisinopril",
                category: "cardiovascular",
                form: "tablet",
                strength: "10mg",
                manufacturer: "CardioPharm",
                quantity: 80,
                reorderLevel: 30,
                cost: 1.50,
                price: 4.00,
                expiry: "2025-03-20",
                batch: "BATCH-LIS-2024",
                description: "ACE inhibitor for hypertension"
            },
            {
                id: "DRG-005",
                name: "Ventolin",
                generic: "Salbutamol",
                category: "respiratory",
                form: "inhaler",
                strength: "100mcg",
                manufacturer: "AsthmaCare",
                quantity: 45,
                reorderLevel: 20,
                cost: 8.00,
                price: 15.00,
                expiry: "2024-11-30",
                batch: "BATCH-VEN-2024",
                description: "Bronchodilator for asthma"
            },
            {
                id: "DRG-006",
                name: "Omeprazole",
                generic: "Omeprazole",
                category: "gastrointestinal",
                form: "capsule",
                strength: "20mg",
                manufacturer: "GastroHealth",
                quantity: 120,
                reorderLevel: 40,
                cost: 1.80,
                price: 4.50,
                expiry: "2025-01-15",
                batch: "BATCH-OME-2024",
                description: "Proton pump inhibitor"
            }
        ];

        // Sample prescriptions data
        const prescriptions = [
            {
                id: "RX-001",
                patientId: "PT-2024-001",
                patientName: "Sarah Johnson",
                doctorId: "DR-001",
                doctorName: "Dr. Smith",
                date: "2024-03-25",
                drugs: [
                    { drugId: "DRG-002", name: "Ibuprofen", dosage: "400mg", frequency: "Every 6 hours", duration: "5 days" }
                ],
                status: "pending",
                notes: "For headache and fever"
            },
            {
                id: "RX-002",
                patientId: "PT-2024-002",
                patientName: "Michael Brown",
                doctorId: "DR-002",
                doctorName: "Dr. Wilson",
                date: "2024-03-25",
                drugs: [
                    { drugId: "DRG-001", name: "Amoxicillin", dosage: "500mg", frequency: "Three times daily", duration: "7 days" }
                ],
                status: "pending",
                notes: "For bacterial infection"
            },
            {
                id: "RX-003",
                patientId: "PT-2024-003",
                patientName: "Emily Davis",
                doctorId: "DR-003",
                doctorName: "Dr. Garcia",
                date: "2024-03-24",
                drugs: [
                                      { drugId: "DRG-005", name: "Ventolin", dosage: "100mcg", frequency: "As needed", duration: "30 days" }
                ],
                status: "ready",
                notes: "For asthma management"
            }
        ];

        // Mobile menu toggle
        document.getElementById('menuToggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            sidebar.style.transform = sidebar.style.transform === 'translateX(0px)' ? 'translateX(-100%)' : 'translateX(0px)';
        });

        // Modal functions
        function showAddDrugModal() {
            document.getElementById('addDrugModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeAddDrugModal() {
            document.getElementById('addDrugModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function showNewPrescriptionModal() {
            alert('New Prescription modal would open here');
            // Implementation for new prescription modal
        }

        function showRestockModal() {
            alert('Restock modal would open here');
            // Implementation for restock modal
        }

        function showExpiryReport() {
            alert('Expiry report would be generated here');
            // Implementation for expiry report
        }

        function showLowStockReport() {
            alert('Low stock report would be generated here');
            // Implementation for low stock report
        }

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === document.getElementById('addDrugModal')) {
                closeAddDrugModal();
            }
        });

        // Render drug inventory
        function renderDrugs(drugList = drugs) {
            const grid = document.getElementById('inventoryGrid');
            grid.innerHTML = '';

            drugList.forEach(drug => {
                const card = document.createElement('div');
                
                // Determine stock status
                let stockStatus = 'good';
                let stockBadge = 'Good Stock';
                if (drug.quantity === 0) {
                    stockStatus = 'critical';
                    stockBadge = 'Out of Stock';
                } else if (drug.quantity <= drug.reorderLevel) {
                    stockStatus = 'low';
                    stockBadge = 'Low Stock';
                }

                card.className = `drug-card ${stockStatus === 'low' ? 'low-stock' : ''} ${stockStatus === 'critical' ? 'critical' : ''}`;
                
                card.innerHTML = `
                    <div class="drug-header">
                        <div class="drug-info">
                            <h4>${drug.name}</h4>
                            <div class="drug-id">${drug.id}</div>
                            <span class="drug-category">${drug.category}</span>
                        </div>
                        <div class="stock-badge ${stockStatus}">${stockBadge}</div>
                    </div>
                    
                    <div class="drug-details">
                        <div class="detail-item">
                            <div class="detail-label">Generic Name</div>
                            <div class="detail-value">${drug.generic}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Form</div>
                            <div class="detail-value">${drug.form}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Strength</div>
                            <div class="detail-value">${drug.strength}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Manufacturer</div>
                            <div class="detail-value">${drug.manufacturer}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Current Stock</div>
                            <div class="detail-value">${drug.quantity} units</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Reorder Level</div>
                            <div class="detail-value">${drug.reorderLevel} units</div>
                        </div>
                    </div>
                    
                    <div class="drug-actions">
                        <button class="drug-action-btn restock" onclick="restockDrug('${drug.id}')">
                            <i class="fas fa-truck-loading"></i> Restock
                        </button>
                        <button class="drug-action-btn dispense" onclick="dispenseDrug('${drug.id}')">
                            <i class="fas fa-pills"></i> Dispense
                        </button>
                        <button class="drug-action-btn edit" onclick="editDrug('${drug.id}')">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Render prescriptions
        function renderPrescriptions(prescriptionList = prescriptions) {
            const list = document.getElementById('prescriptionsList');
            list.innerHTML = '';

            prescriptionList.forEach(prescription => {
                const card = document.createElement('div');
                card.className = `prescription-card ${prescription.status}`;
                
                card.innerHTML = `
                    <div style="width: 40px; height: 40px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white;">
                        <i class="fas fa-prescription"></i>
                    </div>
                    <div class="prescription-info">
                        <h4>${prescription.patientName}</h4>
                        <div class="prescription-meta">
                            <span><i class="fas fa-user-md"></i> ${prescription.doctorName}</span>
                            <span><i class="fas fa-calendar"></i> ${prescription.date}</span>
                            <span><i class="fas fa-pills"></i> ${prescription.drugs.length} drug(s)</span>
                        </div>
                        ${prescription.notes ? `<p style="margin-top: 8px; font-size: 12px; color: var(--gray);">${prescription.notes}</p>` : ''}
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                        <span class="prescription-status status-${prescription.status}">${prescription.status.toUpperCase()}</span>
                        <div style="display: flex; gap: 5px;">
                            <button class="drug-action-btn dispense" onclick="processPrescription('${prescription.id}')" ${prescription.status !== 'pending' ? 'disabled' : ''}>
                                <i class="fas fa-check"></i> Process
                            </button>
                            <button class="drug-action-btn edit" onclick="viewPrescription('${prescription.id}')">
                                <i class="fas fa-eye"></i> View
                            </button>
                        </div>
                    </div>
                `;
                
                list.appendChild(card);
            });
        }

        // Filter drugs
        function filterDrugs() {
            const searchTerm = document.getElementById('searchDrugs').value.toLowerCase();
            const categoryFilter = document.getElementById('filterCategory').value;
            const stockFilter = document.getElementById('filterStock').value;

            const filtered = drugs.filter(drug => {
                const matchesSearch = !searchTerm || 
                    drug.name.toLowerCase().includes(searchTerm) ||
                    drug.generic.toLowerCase().includes(searchTerm) ||
                    drug.id.toLowerCase().includes(searchTerm);
                
                const matchesCategory = !categoryFilter || drug.category === categoryFilter;
                
                let matchesStock = true;
                if (stockFilter === 'critical') {
                    matchesStock = drug.quantity === 0;
                } else if (stockFilter === 'low') {
                    matchesStock = drug.quantity > 0 && drug.quantity <= drug.reorderLevel;
                } else if (stockFilter === 'good') {
                    matchesStock = drug.quantity > drug.reorderLevel;
                }

                return matchesSearch && matchesCategory && matchesStock;
            });

            renderDrugs(filtered);
        }

        // Add event listeners for filters
        document.getElementById('searchDrugs').addEventListener('input', filterDrugs);
        document.getElementById('filterCategory').addEventListener('change', filterDrugs);
        document.getElementById('filterStock').addEventListener('change', filterDrugs);

        // Form submission for adding new drug
        document.getElementById('addDrugForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = {
                name: document.getElementById('drugName').value,
                generic: document.getElementById('drugGeneric').value,
                category: document.getElementById('drugCategory').value,
                form: document.getElementById('drugForm').value,
                strength: document.getElementById('drugStrength').value,
                manufacturer: document.getElementById('drugManufacturer').value,
                quantity: parseInt(document.getElementById('drugQuantity').value),
                reorderLevel: parseInt(document.getElementById('drugReorder').value) || 10,
                cost: parseFloat(document.getElementById('drugCost').value) || 0,
                price: parseFloat(document.getElementById('drugPrice').value) || 0,
                expiry: document.getElementById('drugExpiry').value,
                batch: document.getElementById('drugBatch').value,
                description: document.getElementById('drugDescription').value
            };
            
            // Validate form
            if (!formData.name || !formData.category || !formData.form || !formData.quantity) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Generate drug ID
            const newDrug = {
                id: 'DRG-' + String(drugs.length + 1).padStart(3, '0'),
                ...formData
            };
            
            // Add to drugs array
            drugs.push(newDrug);
            
            // Show success message
            alert('Drug added to inventory successfully!');
            
            // Close modal and reset form
            closeAddDrugModal();
            this.reset();
            
            // Update the inventory view
            renderDrugs();
            updateInventoryStats();
        });

        // Drug action functions
        function restockDrug(drugId) {
            const drug = drugs.find(d => d.id === drugId);
            if (drug) {
                const quantity = prompt(`Enter quantity to restock for ${drug.name}:`, "100");
                if (quantity && !isNaN(quantity)) {
                    drug.quantity += parseInt(quantity);
                    alert(`Restocked ${quantity} units of ${drug.name}`);
                    renderDrugs();
                    updateInventoryStats();
                }
            }
        }

        function dispenseDrug(drugId) {
            const drug = drugs.find(d => d.id === drugId);
            if (drug) {
                if (drug.quantity === 0) {
                    alert('This drug is out of stock!');
                    return;
                }
                
                const quantity = prompt(`Enter quantity to dispense for ${drug.name} (Current stock: ${drug.quantity}):`, "1");
                if (quantity && !isNaN(quantity)) {
                    const dispenseQty = parseInt(quantity);
                    if (dispenseQty > drug.quantity) {
                        alert('Insufficient stock!');
                        return;
                    }
                    
                    drug.quantity -= dispenseQty;
                    alert(`Dispensed ${dispenseQty} units of ${drug.name}`);
                    renderDrugs();
                    updateInventoryStats();
                }
            }
        }

        function editDrug(drugId) {
            const drug = drugs.find(d => d.id === drugId);
            if (drug) {
                alert(`Editing drug: ${drug.name}\nThis would open an edit modal in a real application.`);
                // In real application, open edit modal with drug data
            }
        }

        // Prescription action functions
        function processPrescription(prescriptionId) {
            const prescription = prescriptions.find(p => p.id === prescriptionId);
            if (prescription) {
                // Check if all drugs are available
                const unavailableDrugs = prescription.drugs.filter(drugItem => {
                    const drug = drugs.find(d => d.id === drugItem.drugId);
                    return !drug || drug.quantity === 0;
                });

                if (unavailableDrugs.length > 0) {
                    alert(`Cannot process prescription. The following drugs are unavailable: ${unavailableDrugs.map(d => d.name).join(', ')}`);
                    return;
                }

                // Dispense drugs
                prescription.drugs.forEach(drugItem => {
                    const drug = drugs.find(d => d.id === drugItem.drugId);
                    if (drug) {
                        drug.quantity -= 1; // Assuming 1 unit per prescription for demo
                    }
                });

                prescription.status = 'dispensed';
                alert('Prescription processed successfully!');
                renderPrescriptions();
                renderDrugs();
                updateInventoryStats();
            }
        }

        function viewPrescription(prescriptionId) {
            const prescription = prescriptions.find(p => p.id === prescriptionId);
            if (prescription) {
                let drugList = '';
                prescription.drugs.forEach(drug => {
                    drugList += `• ${drug.name} - ${drug.dosage} - ${drug.frequency} - ${drug.duration}\n`;
                });
                
                alert(`Prescription Details:\n\nPatient: ${prescription.patientName}\nDoctor: ${prescription.doctorName}\nDate: ${prescription.date}\n\nDrugs:\n${drugList}\nNotes: ${prescription.notes}`);
            }
        }

        // Update inventory statistics
        function updateInventoryStats() {
            const totalDrugs = drugs.length;
            const lowStockItems = drugs.filter(d => d.quantity > 0 && d.quantity <= d.reorderLevel).length;
            const outOfStock = drugs.filter(d => d.quantity === 0).length;
            const expiringSoon = drugs.filter(d => {
                if (!d.expiry) return false;
                const expiryDate = new Date(d.expiry);
                const thirtyDaysFromNow = new Date();
                thirtyDaysFromNow.setDate(thirtyDaysFromNow.getDate() + 30);
                return expiryDate <= thirtyDaysFromNow;
            }).length;

            // Update the stats display (in a real app, you'd update the DOM elements)
            console.log('Inventory stats updated:', { totalDrugs, lowStockItems, outOfStock, expiringSoon });
        }

        // Export inventory
        function exportInventory() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "ID,Name,Generic Name,Category,Form,Strength,Quantity,Reorder Level,Price\n"
                + drugs.map(drug => 
                    `${drug.id},${drug.name},${drug.generic},${drug.category},${drug.form},${drug.strength},${drug.quantity},${drug.reorderLevel},${drug.price}`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "pharmacy_inventory.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            renderDrugs();
            renderPrescriptions();
            updateInventoryStats();
        });

        // Real-time stock alerts simulation
        function simulateStockAlerts() {
            setInterval(() => {
                const criticalDrugs = drugs.filter(d => d.quantity === 0);
                const lowStockDrugs = drugs.filter(d => d.quantity > 0 && d.quantity <= d.reorderLevel);
                
                if (criticalDrugs.length > 0 || lowStockDrugs.length > 0) {
                    // In a real application, you'd update notification badges
                    const notificationBadge = document.querySelector('.notification-badge');
                    if (notificationBadge) {
                        const currentCount = parseInt(notificationBadge.textContent) || 0;
                        const newCount = criticalDrugs.length + lowStockDrugs.length;
                        if (newCount > currentCount) {
                            notificationBadge.textContent = newCount;
                            notificationBadge.style.animation = 'pulse 1s infinite';
                            setTimeout(() => {
                                notificationBadge.style.animation = '';
                            }, 3000);
                        }
                    }
                }
            }, 30000); // Check every 30 seconds
        }

        // Start real-time alerts
        simulateStockAlerts();

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl + D for new drug
            if (e.ctrlKey && e.key === 'd') {
                e.preventDefault();
                showAddDrugModal();
            }
            
            // Ctrl + P for new prescription
            if (e.ctrlKey && e.key === 'p') {
                e.preventDefault();
                showNewPrescriptionModal();
            }
            
            // Escape to close modal
            if (e.key === 'Escape') {
                closeAddDrugModal();
            }
        });
    </script>
</body>
</html>